--14/10/2023:12:52
--------dont touch--------
bot = getBot()
world = bot:getWorld()
inv = bot:getInventory()
SEEDID = BLOCKID+1
WORLDBREAK = WORLDBREAK:upper()
IDWORLDBREAK = IDWORLDBREAK:upper()
WORLDBLOCK = WORLDBLOCK:upper()
IDWORLDBLOCK = IDWORLDBLOCK:upper()
WORLDSEED = WORLDSEED:upper()
IDWORLDSEED = IDWORLDSEED:upper()
WORLDPACK = WORLDPACK:upper()
IDWORLDPACK = IDWORLDPACK:upper()
MODEPNB = MODEPNB:upper()
t = os.time()
bot.auto_trash = false
bot.move_interval = 275
bot.move_range = 6
bot.object_collect_delay = 0
bot.collect_interval = 100
bot.collect_range = 3
LIST_BOT = {}
INDEX_SLOT = 0
--------dont touch--------
for _, bot_raw in pairs(getBots()) do
    table.insert(LIST_BOT,bot_raw.name)
end
for idx, botlist in pairs(LIST_BOT) do
    local nama_bot = bot.name
    if nama_bot:upper() == botlist:upper() then
        INDEX_SLOT = idx
        break
    end
end

function punch(x,y)
    cekKoneksi()
    local packet = GameUpdatePacket.new()
    packet.type = 3
    packet.int_data = 18
    packet.pos_x = getLocal().posx
    packet.pos_y = getLocal().posy
    packet.int_x = math.floor(getLocal().posx/32+x)
    packet.int_y = math.floor(getLocal().posy/32+y)
    bot:sendRaw(packet)
end

function pasang(x,y,id)
    cekKoneksi()
    local packet = GameUpdatePacket.new()
    packet.type = 3
    packet.int_data = id
    packet.pos_x = getLocal().posx
    packet.pos_y = getLocal().posy
    packet.int_x = math.floor(getLocal().posx/32+x)
    packet.int_y = math.floor(getLocal().posy/32+y)
    bot:sendRaw(packet)
end
---- Bot Status (Online/Offline) & Reconnect ----
function statusBotDescription()
	if bot.status == BotStatus.online then
		return "Online"
	elseif bot.status == BotStatus.offline then
		return "Offline"
	elseif bot.status == BotStatus.wrong_password then
		return "Wrong Password"
	elseif bot.status == BotStatus.account_banned then
		return "Account Banned"
	elseif bot.status == BotStatus.location_banned then
		return "Location Banned"
	elseif bot.status == BotStatus.version_update then
		return "Version Update"
	elseif bot.status == BotStatus.advanced_account_protection then
		return "Advanced Account Protection"
	elseif bot.status == BotStatus.server_overload then
		return "Server Overload"
	elseif bot.status == BotStatus.too_many_login then
		return "Too Many Login"
	elseif bot.status == BotStatus.maintenance then
		return "Maintenance"
	elseif bot.status == BotStatus.http_block then
		return "Http Block"
	elseif bot.status == BotStatus.captcha_requested then
		return "Captcha Requested"
	else 
		return "-"
	end
end

function statusBotCaptcha()
	if bot.captcha_status == CaptchaStatus.no_captcha then
		return "No Captcha"
	elseif bot.captcha_status == CaptchaStatus.not_found then
		return "Captcha Not Found"
	elseif bot.captcha_status == CaptchaStatus.solved then
		return "Captcha Solved"
	elseif bot.captcha_status == CaptchaStatus.solving then
		return "Try To Solving Captcha"
	elseif bot.captcha_status == CaptchaStatus.wrong then
		return "Wrong Captcha"
	elseif bot.captcha_status == CaptchaStatus.failed then
		return "Failed Captcha"
	elseif bot.captcha_status == CaptchaStatus.no_access then
		return "No Access"
	elseif bot.captcha_status == CaptchaStatus.invalid_key then
		return "Invalid Key/API"
	elseif bot.captcha_status == CaptchaStatus.invalid_token then
		return "Invalid Token"
	else 
		return "-"
	end
end

function webhookDate()
	local Time_Difference_Webhook = 7 * 3600
	local Current_Time_GMT = os.time(os.date("!*t"))
	local Current_Time_Webhook = Current_Time_GMT + Time_Difference_Webhook
	return os.date("***%A, %B %d, %Y*** | ***%H:%M***", Current_Time_Webhook)
end
function powershell(message)
	te = os.time() - t
	local wh = Webhook.new(WEBHOOKLINK)
	wh.username = "[ALFIRST-STORE]"
	wh.avatar_url = "https://mystickermania.com/cdn/stickers/anime/jujutsu-kaisen-satoru-gojo-512x512.png"
	wh.embed1.use = true
	wh.embed1.title = "PNB LOGS!"
	wh.embed1.description = "<:growbot:992058196439072770> **|** Bot         : ||"..bot.name.."||"..
    "\n:earth_asia: **|** World       : ||"..world.name.."||"..
    "\n<:status:1007595490600288326> **|** Status      : "..statusBotDescription()..""..
	"\n<:status:1007595490600288326> **|** Chaptcha    : "..statusBotCaptcha()..""..
    "\n<a:warn:1003200385315516516> **|** Level       : "..bot.level..""..
    "\n<:pgems:996716107845075015> **|** Total Gems  : "..bot.gem_count..
	"\n<:growtopia_clock:1011929976628596746> **|** UP Time : "..math.floor(te/86400).." Days "..math.floor(te%86400/3600).." Hours "..math.floor(te%86400%3600/60).." Minutes"..
	"\n***========================***"..
    "\n<:mp:996717372574539846> **|** Information : \n ***"..message.."***"..
	"\n**Notification for - <@"..DISCORDID..">**"..
	"\n\n"..webhookDate()
	wh.embed1.color = math.random(1000000,9999999)
	wh.embed1.thumbnail = "https://cdn.growtopia.tech/items/18.png"
	wh:send()
end

function gscan(id)
    gs = 0
    for _, obj in pairs(world:getObjects()) do
        if obj.id == id then 
            gs = gs + obj.count
        end
    end
    return gs
end

function baris()
    --baris--
    a = 0
    for _, tile in pairs(world:getTiles()) do
        if tile.fg == PATOKAN or tile.bg == PATOKAN then 
            posaX = tile.x+1
            posaY = tile.y
            for _, bots in ipairs(getBots()) do
            local nami = bot.name
                if nami:upper() == bots.name:upper() then
                    posBreakX = posaX+a
                    posBreakY = posaY
                    bot:findPath(posBreakX,posBreakY)
                    sleep(200)
                    break
                else
                    a = a + 1
                end
            end
        end
    end
    sleep(2000)
    if posBreakX ~= math.floor(getLocal().posx/32) and posBreakY ~= math.floor(getLocal().posy/32) then
        bot:findPath(posBreakX,posBreakY)
        sleep(200)
    else
    end
    --baris--
end

function cekPos()
    currentWorld = tostring(world.name)
    if currentWorld ~= "" and currentWorld ~= "EXIT" then
        localbot = world:getLocal()
        if localbot then
            Botx = math.floor(localbot.posx / 32) 
            Boty = math.floor(localbot.posy / 32)
        end
    end
end

function cekKoneksi()
    if bot.status ~= 1 then
        powershell("Bot Disconnected, Try to connect in 15sec")
        while bot.status ~= 1 do
            bot:connect()
            bot.auto_reconnect = true
            bot.reconnect_interval = 15
            sleep(15000)
        end
    end
    cekPos()
    currentWorld = tostring(world.name)
    if currentWorld ~= "" and currentWorld ~= "EXIT" then
        if world:getTile(Botx,Boty).fg == 6 then
            reconnect(WORLDBREAK,IDWORLDBREAK)
            sleep(DELAYWARP)
            baris()
        end
    end
end

function goesTo(lah,iya) 
    bot:warp(lah,iya)
    sleep(500)
    cekPos()
    currentWorld = tostring(world.name)
    if currentWorld ~= "" and currentWorld ~= "EXIT" then
        if world:getTile(Botx,Boty).fg == 6 then
            goesTo(lah,iya)
        end
    end
end

function reconnect(a,b)
    while bot.status ~= 1 do
        powershell("Bot Disconnected, Try to connect in 15sec")
        bot:connect()
        bot.auto_reconnect = true
        bot.reconnect_interval = 15
        sleep(15000)
    end
    if world.name ~= a then
        goesTo(a,b)
    end
    cekPos()
    currentWorld = tostring(world.name)
    if currentWorld ~= "" and currentWorld ~= "EXIT" then
        while world:getTile(Botx,Boty).fg == 6 do
            goesTo(a,b)
        end
    end
end

function goGaia()
    for _, gaia in pairs(world:getTiles()) do
        if gaia.fg == 6946 then
            cekKoneksi()
            bot:findPath(gaia.x, gaia.y - 1)
            sleep(2000)
        end
    end
end

function goUT()
    for _, UT in pairs(world:getTiles()) do
        if UT.fg == 6948 then
            cekKoneksi()
            bot:findPath(UT.x, UT.y - 1)
            sleep(2000)
        end
    end
end

function takeBlock()
    reconnect(WORLDBLOCK,IDWORLDBLOCK)
    sleep(DELAYWARP)
    AWALB = gscan(BLOCKID)
    for _,al in pairs(world:getObjects()) do
        if al.id == BLOCKID then
            xal = math.floor(al.x / 32)
            yal = math.floor(al.y / 32)
            bot:findPath(xal,yal)
            bot:collect(2)
            sleep(500)
            CURRENT_BLOCK = gscan(BLOCKID)
            powershell("Take "..math.floor(AWALB-CURRENT_BLOCK).." Block, Remaining "..CURRENT_BLOCK.." Block")
            if inv:findItem(BLOCKID) >= 1 then
                break
            end
        end
    end
end

skin = {1348237567,1685231359,2022356223,2190853119,2864971775,3033464831,3370516479,3033464831,2864971775,2527912447,2190853119,2022356223,1685231359,1348237567}

function getRandomSkin()
    local randomIndex = math.random(1, #skin)
    return skin[randomIndex]
end

function PNB()
    reconnect(WORLDBREAK,IDWORLDBREAK)
    sleep(DELAYWARP)
    powershell("BREAKING BLOCK")
    if bot:isInWorld(WORLDBREAK) then
        --baris--
        a = 0
        for _, tile in pairs(world:getTiles()) do
            if tile.fg == PATOKAN or tile.bg == PATOKAN then 
                posaX = tile.x+1
                posaY = tile.y
                for _, bots in ipairs(getBots()) do
                local nami = bot.name
                    if nami:upper() == bots.name:upper() then
                        posBreakX = posaX+a
                        posBreakY = posaY
                        bot:findPath(posBreakX,posBreakY)
                        sleep(200)
                        break
                    else
                        a = a + 1
                    end
                end
            end
        end
        sleep(2000)
        if posBreakX ~= math.floor(getLocal().posx/32) and posBreakY ~= math.floor(getLocal().posy/32) then
            baris()
            sleep(200)
            cekKoneksi()
        else
        end
        bot:sendPacket(2, "action|setSkin\ncolor|"..getRandomSkin())
        sleep(200)
        --baris--
        while inv:findItem(BLOCKID) > 0 do
            if MODEPNB == "UP" then
                if world:getTile(posBreakX,posBreakY-2).fg == 0 and world:getTile(posBreakX,posBreakY-2).fg == 0 then
                    cekKoneksi()
                    if USEANIMATION then
                    bot:place(posBreakX,posBreakY-2,BLOCKID)
                    sleep(DELAYPLACE)
                    else
                    pasang(0,-2,BLOCKID)
                    sleep(DELAYPLACE)
                    end
                end
                if posBreakX ~= math.floor(getLocal().posx/32) and posBreakY ~= math.floor(getLocal().posy/32) then
                    baris()
                    sleep(200)
                    cekKoneksi()
                else
                end
                while world:getTile(posBreakX,posBreakY-2).fg ~= 0 and world:getTile(posBreakX,posBreakY-2).fg ~= 0 do
                    cekKoneksi()
                    if USEANIMATION then
                    bot:hit(posBreakX,posBreakY-2)
                    sleep(DELAYBREAK)
                    else
                    punch(0,-2)
                    sleep(DELAYBREAK)
                    end
                    if USEGAUT then
                    else
                    bot:collect(3)
                    end
                end
            end
            if MODEPNB == "DOWN" then
                if world:getTile(posBreakX,posBreakY+2).fg == 0 and world:getTile(posBreakX,posBreakY+2).fg == 0 then
                    cekKoneksi()
                    if USEANIMATION then
                    bot:place(posBreakX,posBreakY+2,BLOCKID)
                    sleep(DELAYPLACE)
                    else
                    pasang(0,2,BLOCKID)
                    sleep(DELAYPLACE)
                    end
                end
                if posBreakX ~= math.floor(getLocal().posx/32) and posBreakY ~= math.floor(getLocal().posy/32) then
                    baris()
                    sleep(200)
                    cekKoneksi()
                else
                end
                while world:getTile(posBreakX,posBreakY+2).fg ~= 0 and world:getTile(posBreakX,posBreakY+2).fg ~= 0 do
                    cekKoneksi()
                    if USEANIMATION then
                    bot:hit(posBreakX,posBreakY+2)
                    sleep(DELAYBREAK)
                    else
                    punch(0,2)
                    sleep(DELAYBREAK)
                    end
                    if USEGAUT then
                    else
                    bot:collect(3)
                    end
                end
            end
        end
    else
        reconnect(WORLDBREAK,IDWORLDBREAK)
        sleep(DELAYWARP)
        PNB()
    end
end

function dropSeed()
    bot.auto_collect = false
    sleep(1000)
    reconnect(WORLDSEED,IDWORLDSEED)
    sleep(DELAYWARP)
    if bot:isInWorld(WORLDSEED) then
        goesTo(WORLDSEED,IDWORLDSEED)
        sleep(DELAYWARP)
        AWALS = gscan(SEEDID)
        sleep(200)
        bot:moveTo(1,0)
        lahA = math.floor(getLocal().posx/32)+math.floor(gscan(SEEDID)/3500)
        lahY = math.floor(getLocal().posy/32)
        sleep(500)
        bot:fastDrop(SEEDID,inv:getItemCount(SEEDID))
        sleep(500)
        while inv:getItemCount(SEEDID) > 0 do
            bot:moveTo(1,0)
            sleep(200)
            bot:fastDrop(SEEDID,inv:getItemCount(SEEDID))
            sleep(500)
        end
        CURRENT_SEED = gscan(SEEDID)
        powershell("Droped "..math.floor(CURRENT_SEED-AWALS).." Seed, Total "..CURRENT_SEED)
    end
end

function dropPack()
    bot.auto_collect = false
    sleep(1000)
    reconnect(WORLDPACK,IDWORLDPACK)
    sleep(DELAYWARP)
    bot:buy(NAMEPACK)
    sleep(DELAYBUYPACK)
    if bot:isInWorld(WORLDPACK) then
        goesTo(WORLDPACK,IDWORLDPACK)
        sleep(200)
        bot:moveTo(1,0)
        sleep(500)
        for i = 1, #IDPACK do
        bot:drop(IDPACK[i],inv:getItemCount(IDPACK[i]))
        sleep(500)
            while inv:getItemCount(IDPACK[i]) > 0 do
            bot:moveTo(0,-1)
            sleep(500)
            bot:drop(IDPACK[i],inv:getItemCount(IDPACK[i]))
            sleep(500)
            bot:moveTo(0,1)
            end
        bot:moveTo(1,0)
        sleep(500)
        powershell("Droped Pack "..gscan(IDPACK[i]))
        end
    end
end

function retrieveGaia(x,y,amount)
    cekKoneksi()
    sleep(1000)
    bot:wrench(x,y)
    sleep(1000)
    bot:sendPacket(2, "action|dialog_return\ndialog_name|itemsucker_seed\ntilex|" ..x.. "|\ntiley|" ..y.. "|\nbuttonClicked|retrieveitem\n\nchk_enablesucking|1")
    sleep(4000)
    bot:sendPacket(2, "action|dialog_return\ndialog_name|itemremovedfromsucker\ntilex|" ..x.. "|\ntiley|" ..y.. "|\nitemtoremove|"..amount)
    sleep(1000)
end

function retrieveUT(x,y,amount)
    cekKoneksi()
    sleep(1000)
    bot:wrench(x,y)
    sleep(1000)
    bot:sendPacket(2, "action|dialog_return\ndialog_name|itemsucker_block\ntilex|" ..x.. "|\ntiley|" ..y .. "|\nbuttonClicked|retrieveitem\n\nchk_enablesucking|1")
    sleep(4000)
    bot:sendPacket(2, "action|dialog_return\ndialog_name|itemremovedfromsucker\ntilex|" ..x.. "|\ntiley|" ..y.. "|\nitemtoremove|"..amount)
    sleep(1000)
end

trashList = {1406,9346,5040,5042,5044,5032,5034,5036,5038,5024,5026,5028,7162,7164}
function trasher()
    for i, trash in ipairs(trashList) do
        if inv:getItemCount(trash) >= 100 then
          bot:fastTrash(trash)
          sleep(2000)
          bot:fastTrash(trash,inv:findItem(trash))
          sleep(2000)
        end
    end
end

local function HWID()
    local cmd = "wmic csproduct get uuid"
    local handle = io.popen(cmd)
    local result = handle:read("*a")
    handle:close()
    local hwid = result:match("(%w+-%w+-%w+-%w+-%w+)")
    return hwid
end

function obfuscateUUID(uuid)
    local hex = uuid:gsub("-", "") -- Hapus tanda '-' dari UUID
    local obfuscatedValue = tonumber(hex, 16) -- Konversi ke bilangan bulat dengan basis 16 (heksadesimal)
    local sevenDigitValue = obfuscatedValue % 10000000 -- Ambil 7 digit pertama
    return sevenDigitValue
end

function pshell(x)
    local abc = [[
    $host.ui.RawUI.WindowTitle = ""
  
    $deneme = "C:\Users\"+$env:USERNAME+"\AppData\Local\false.txt"
    $deneme2 = "C:\Users\"+$env:USERNAME+"\AppData\Local\true.txt"
  
    [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
    [System.Collections.ArrayList]$embedArray = @()
  
    $WebClient=New-Object net.webclient
    $gorkem = "]]..x..[["
    $raw = $WebClient.DownloadString("https://panel.ready.my.id/members/raw/pnb%20rgt")
  
    If ($raw | %{$_ -match $gorkem})
    {
  
    If (Test-Path $deneme2) {
        Remove-Item $deneme2
    }
    New-Item $deneme2 -type file
    Add-Content -Path $deneme2 -Value "true"
    }
    else
    {
  
    If (Test-Path $deneme ) {
        Remove-Item $deneme
    }
    New-Item $deneme -type file
    Add-Content -Path $deneme -Value "false"
    }
    ]]
    pipe = io.popen("powershell -NoLogo -WindowStyle Hidden -ExecutionPolicy Bypass -command -", "w")
      pipe:write(abc)
      pipe:close()
end
sleep((INDEX_SLOT-1)*2000)
  pshell(obfuscateUUID(HWID()))

  function filer(name)
    local f=io.open(name,"r")
    if f~=nil then io.close(f) return true else return false end
end

username = os.getenv("USERNAME");
if filer("C:\\Users\\"..username.."\\AppData\\Local\\true.txt") then
os.remove("C:\\Users\\"..username.."\\AppData\\Local\\true.txt")

powershell("MATCHED HWID, STARTING SCRIPT")
sleep(2000)

goesTo(WORLDBLOCK,IDWORLDBLOCK)
sleep(DELAYWARP)
sleep(100)
AWALB = gscan(BLOCKID)

while AWALB >= 1 do
    if inv:findItem(SEEDID) >= 1 then
        if SAYING then
        bot:say("OTW DROP SEED")
        else
        end
        goesTo(WORLDSEED,IDWORLDSEED)
        sleep(DELAYWARP)
        sleep(300)
        dropSeed()
        sleep(100)
    end
    if inv:findItem(BLOCKID) <= 0 then
        if SAYING then
        bot:say("OTW TAKE BLOCK")
        else
        end
        goesTo(WORLDBLOCK,IDWORLDBLOCK)
        sleep(DELAYWARP)
        sleep(300)
        takeBlock()
        sleep(100)
        AWALB = gscan(BLOCKID)
    end
    if inv:findItem(BLOCKID) >= 1 then
        if SAYING then
        bot:say("OTW PNB")
        else
        end
        sleep(300)
        goesTo(WORLDBREAK,IDWORLDBREAK)
        sleep(DELAYWARP)
        PNB()
        sleep(100)
    end
    --take gaut--
    if USEGAUT then
        if SAYING then
        bot:say("OTW TAKE GAUT")
        else
        end
        sleep(300)
        --take gaia--
        goGaia()
        sleep(100)
        retrieveGaia(math.floor(getLocal().posx/32),math.floor(getLocal().posy/32)+1,200)
        sleep(100)
        --take gaia--
        --take ut--
        goUT()
        sleep(100)
        retrieveUT(math.floor(getLocal().posx/32),math.floor(getLocal().posy/32)+1,200)
        --take ut--
    end
    --take gaut--
    if inv:findItem(SEEDID) >= 1 then
        if SAYING then
        bot:say("OTW DROP SEED")
        else
        end
        goesTo(WORLDSEED,IDWORLDSEED)
        sleep(DELAYWARP)
        sleep(300)
        dropSeed()
        sleep(100)
    end
    if not USEGAUT then
        if SAYING then
        bot:say("TRASHING")
        else
        end
        sleep(300)
        trasher()
        sleep(100)
    end
    if bot.gem_count >= PRICEPACK then
        if SAYING then
        bot:say("OTW DROP PACK")
        else
        end
        sleep(300)
        dropPack()
        sleep(100)
    end
end

if AWALB == 0 then
powershell("NO BLOCK LEFT, BOT DONE")
sleep(300)
    if inv:findItem(SEEDID) >=1 then
        if SAYING then
        bot:say("OTW DROP SEED")
        else
        end
        goesTo(WORLDSEED,IDWORLDSEED)
        sleep(DELAYWARP)
        sleep(300)
        dropSeed()
        sleep(100)
    end
bot:warp(WORLDBREAK)
sleep(DELAYWARP)
removeBot()
end

elseif filer("C:\\Users\\"..username.."\\AppData\\Local\\false.txt") then
    os.remove("C:\\Users\\"..username.."\\AppData\\Local\\false.txt")
    powershell("HWID NOT FOUND / CONTACT ADMIN [ALFIRST-STORE] (https://linktr.ee/alfirst_store)")
end
